# XAI-IDS-IoT
 A lightweight, explainable AI-based DDoS attack detection system for IoT and traditional networks. Utilizes autoencoders and SHAP for anomaly detection and feature influence analysis, achieving high accuracy on the USB-IDS dataset. Ideal for resource-constrained IoT devices. A hybrid Explainable AI-based Intrusion Detection System for IoT Networks. This project implements anomaly detection and DDoS mitigation techniques using interpretable machine learning models such as SHAP and LIME, aiming to enhance transparency, trust, and decision support in IoT cybersecurity systems.

Explainable AI-Based DDoS Attack Detection for IoT Networks
Overview
This repository contains the implementation of an Explainable Artificial Intelligence (XAI)-based method for detecting Distributed Denial of Service (DDoS) attacks in IoT and traditional networks, as described in the paper Explainable AI-Based DDoS Attack Identification Method for IoT Networks (Computers 2023, 12, 32). The system uses a combination of autoencoders for anomaly detection and SHAP (SHapley Additive exPlanations) for identifying influential features, providing high detection accuracy and interpretability. The method is designed to be lightweight, making it suitable for deployment on resource-constrained IoT devices.
The approach focuses on analyzing network traffic at the network layer (Layer 3) to detect anomalies without inspecting packet payloads, thus preserving user privacy. It identifies DDoS attacks by extracting and analyzing features related to volumetric, TCP state-exhaustion, and application-layer attacks, and maps the most influential features to predefined DDoS attack indicators.
Features

Anomaly Detection: Uses a lightweight autoencoder model to detect network anomalies based on reconstruction error.
Explainable AI: Employs SHAP to identify and explain the most influential features contributing to detected anomalies.
Feature Extraction: Extracts 21 key features (volumetric, TCP state-exhaustion, and application-layer) using CICFlowMeter.
Threshold-Based Detection: Defines thresholds for each feature to distinguish DDoS attack flows from benign traffic.
Privacy-Preserving: Analyzes packet headers instead of payloads to ensure user privacy.
Lightweight Design: Optimized for IoT devices, tested on Raspberry Pi 4 and ASUS ZenBook.
High Accuracy: Achieves superior detection performance (e.g., 0.98–1.0 accuracy on USB-IDS dataset) compared to state-of-the-art methods like Decision Trees, Random Forests, and Deep Neural Networks.

Dataset
The model was evaluated using the USB-IDS dataset, which includes 17 labeled CSV files with network traffic data, including benign and DDoS attack flows (e.g., HULK attacks). The dataset uses CICFlowMeter for feature extraction and provides explicit feature explanations.
Requirements
To run the code, ensure you have the following installed:

Python 3.8+
TensorFlow Lite
Keras
SHAP
Pandas
NumPy
Scikit-learn
CICFlowMeter (for feature extraction from pcap files)
Hardware: Tested on ASUS ZenBook (Intel Core i7, 16GB RAM) and Raspberry Pi 4 (4GB RAM)

You can install the required Python packages using:
pip install tensorflow keras shap pandas numpy scikit-learn

Installation

Clone the Repository:
git clone https://github.com/yourusername/xai-ddos-detection.git](https://github.com/SreekarSBS/XAI-IDS-IoT.git
cd xai-ddos-detection


Install CICFlowMeter:Download and install CICFlowMeter to extract features from network traffic (pcap files).

Prepare the Dataset:

Download the USB-IDS dataset and place it in the data/ directory.
Ensure the dataset is in CSV format as generated by CICFlowMeter.


Set Up the Environment:Create a virtual environment and install dependencies:
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt



Usage

Feature Extraction:

Use CICFlowMeter to process pcap files and generate CSV files with 84 network traffic features.
Apply min-max normalization to the extracted features (script provided in preprocessing/normalize.py).


Train the Autoencoder:

Run the training script to train the autoencoder on benign traffic data:python train_autoencoder.py --data data/benign.csv --output models/autoencoder.h5


The script uses a fully connected autoencoder with 2 hidden layers (10 and 32 neurons), ReLU activation, Adam optimizer (learning rate 0.01), and 40 epochs.


Detect Anomalies:

Use the trained model to detect anomalies in test data:python detect_anomalies.py --model models/autoencoder.h5 --data data/test.csv --output results/anomalies.csv


Anomalies are identified based on reconstruction error exceeding the mean squared error (MSE) threshold.


Explain Anomalies with SHAP:

Generate SHAP explanations for detected anomalies:python explain_anomalies.py --anomalies results/anomalies.csv --model models/autoencoder.h5 --output results/shap_values.csv


This script identifies the top influential features for each anomalous instance.


Map to DDoS Features:

Map influential features to DDoS-specific features and detect attacks:python detect_ddos.py --shap results/shap_values.csv --output results/ddos_detections.csv


Features exceeding predefined thresholds are classified as DDoS attacks.



Project Structure
xai-ddos-detection/
├── data/                    # Dataset (USB-IDS CSV files)
├── models/                  # Trained autoencoder model
├── results/                 # Output files (anomalies, SHAP values, DDoS detections)
├── preprocessing/           # Scripts for feature extraction and normalization
│   └── normalize.py
├── train_autoencoder.py     # Script to train the autoencoder
├── detect_anomalies.py      # Script to detect anomalies
├── explain_anomalies.py     # Script to generate SHAP explanations
├── detect_ddos.py           # Script to map features and detect DDoS attacks
├── requirements.txt         # Python dependencies
└── README.md                # This file

Results
The proposed method was evaluated on the USB-IDS dataset for HULK attacks:

Hulk No Defense: 0.98 accuracy
Hulk Evasive: 1.0 accuracy
Hulk Reqtimeout: 1.0 accuracy

These results outperform state-of-the-art methods:

Decision Tree: 0.97, 0.06, 0.97
Random Forest: 0.98, 0.00, 0.98
Deep Neural Network: 0.67, 0.05, 0.66

Key influential features for DDoS detection include:

Flow packets per second (flow packets/s)
Backward packets per second (bwd packets/s)
Maximum backward packet length (bwd packet length max)
Forward packet length variance (fwd packet length std)

Future Work

Deploy the system in real-time IoT networks with simulated attacks.
Enhance the model to handle additional attack types and datasets.
Optimize for even lower resource usage on IoT devices.

Citation
If you use this code in your research, please cite the original paper:
@article{kalutharage2023explainable,
  title={Explainable AI-Based DDoS Attack Identification Method for IoT Networks},
  author={Kalutharage, Chathuranga Sampath and Liu, Xiaodong and Chrysoulas, Christos and Pitropakis, Nikolaos and Papadopoulos, Pavlos},
  journal={Computers},
  volume={12},
  number={2},
  pages={32},
  year={2023},
  publisher={MDPI}
}

License
This project is licensed under the MIT License. See the LICENSE file for details.
Contact
For questions or contributions, please open an issue or contact the repository maintainers.
